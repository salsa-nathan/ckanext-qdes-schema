{% import 'macros/form.html' as form %}

{% resource 'qdes_schema/repeating-fields.js' %}

<div id="{{ field.field_name }}-repeater" class="repeating-field">

    <div data-repeater-list="{{ field.field_name }}">

        {% set values = h.get_multi_textarea_values(data[field.field_name]) or [] %}

        {% for value in values %}
        <div data-repeater-item class="row">
            <div class="col-lg-1">
                <br /><br />
                <input data-repeater-delete type="button" class="btn btn-sm btn-danger" value="-" title="Remove item" />
            </div>
            <div class="col-lg-11">
                {% call form.textarea(
                    'item-' + field.field_name,
                    id='field-item-' + field.field_name,
                    label=h.scheming_language_text(field.label),
                    placeholder=h.scheming_language_text(field.form_placeholder),
                    attrs=dict({"class": "form-control"}, **(field.get('form_attrs', {}))),
                    is_required=h.scheming_field_required(field),
                    value=value
                    )
                %}
                {% endcall %}
            </div>
        </div>
        {% endfor %}

    </div>
    <div class="row" align="center">
        <input data-repeater-create type="button" class="btn" value="+" />
    </div>
</div>

	<button class="collate-inputs"
            data-repeater-id="{{ field.field_name }}-repeater"
            data-target-field-id="{{ 'field-' + field.field_name }}"
            data-field-type="textarea">
        collate-inputs
    </button>

{# BEGIN: The actual field the multiple values will be capture & submitted in #}
{% call form.textarea(
    field.field_name,
    id='field-' + field.field_name,
    label=h.scheming_language_text(field.label),
    placeholder=h.scheming_language_text(field.form_placeholder),
    value=data[field.field_name],
    error=errors[field.field_name],
    attrs=dict({"class": "form-control"}, **(field.get('form_attrs', {}))),
    is_required=h.scheming_field_required(field),
    )
%}
    {%- snippet 'scheming/form_snippets/help_text.html', field=field -%}
{% endcall %}
{# END: The actual field the multiple values will be capture & submitted in #}